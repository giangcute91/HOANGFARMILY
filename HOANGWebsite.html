<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>GIA PHẢ HOÀNG TỘC</title>
    <!-- <script src="HOANGchart.js"></script> -->
    <script src="https://balkan.app/js/OrgChart.js"></script>
    <!-- <script src="https://balkangraph.com/js/latest/OrgChart.js"></script> -->
    
    <!-- Refre: https://balkan.app/OrgChartJS/Demos/RoyalFamilyTree -->
    <!-- Refer:https://balkan.app/OrgChartJS/Docs/GettingStarted -->
    <style id="myStyles">
        html, body {
            margin: 0px;
            padding: 0px;
            width: 100%;
            height: 100%;
            font-family: Helvetica;
            overflow: hidden;
            }
    
        #tree {
            width: 100%;
            height: 100%;
        }
    </style>
</head>
<body>
    <div id="tree"></div>
    <div id="rankings"></div>
    <script>
    function fetchJSONFile(path, callback) {
            var httpRequest = new XMLHttpRequest();
            httpRequest.onreadystatechange = function() {
                if (httpRequest.readyState === 4) {
                    if (httpRequest.status === 200) {
                        var data = JSON.parse(httpRequest.responseText);
                        if (callback) callback(data);
                    }
                }
            };
            httpRequest.open('GET', path);
            httpRequest.send(); 
    }
    
    window.onload = function () {
        OrgChart.icon.info = function (w, h, c) {
        return '<svg width="' + w + '" height="' + h + '" viewBox="0 0 128 128">'
            + '<path fill="' + c + '" d="M78.962,99.536l-1.559,6.373c-4.677,1.846-8.413,3.251-11.195,4.217c-2.785,0.969-6.021,1.451-9.708,1.451'
        + 'c-5.662,0-10.066-1.387-13.207-4.142c-3.141-2.766-4.712-6.271-4.712-10.523c0-1.646,0.114-3.339,0.351-5.064'
        + 'c0.239-1.727,0.619-3.672,1.139-5.846l5.845-20.688c0.52-1.981,0.962-3.858,1.316-5.633c0.359-1.764,0.532-3.387,0.532-4.848'
        + 'c0-2.642-0.547-4.49-1.636-5.529c-1.089-1.036-3.167-1.562-6.252-1.562c-1.511,0-3.064,0.242-4.647,0.71'
        + 'c-1.59,0.47-2.949,0.924-4.09,1.346l1.563-6.378c3.829-1.559,7.489-2.894,10.99-4.002c3.501-1.111,6.809-1.667,9.938-1.667'
        + 'c5.623,0,9.962,1.359,13.009,4.077c3.047,2.72,4.57,6.246,4.57,10.591c0,0.899-0.1,2.483-0.315,4.747'
        + 'c-0.21,2.269-0.601,4.348-1.171,6.239l-5.82,20.605c-0.477,1.655-0.906,3.547-1.279,5.676c-0.385,2.115-0.569,3.731-0.569,4.815'
        + 'c0,2.736,0.61,4.604,1.833,5.597c1.232,0.993,3.354,1.487,6.368,1.487c1.415,0,3.025-0.251,4.814-0.744'
        + 'C76.854,100.348,78.155,99.915,78.962,99.536z M80.438,13.03c0,3.59-1.353,6.656-4.072,9.177c-2.712,2.53-5.98,3.796-9.803,3.796'
        + 'c-3.835,0-7.111-1.266-9.854-3.796c-2.738-2.522-4.11-5.587-4.11-9.177c0-3.583,1.372-6.654,4.11-9.207'
        + 'C59.447,1.274,62.729,0,66.563,0c3.822,0,7.091,1.277,9.803,3.823C79.087,6.376,80.438,9.448,80.438,13.03z"/>'
        + '</svg>';
        };
        OrgChart.templates.ula.nodeCircleMenuButton = {
                radius: 18,
                x: 210,
                y: 120,
                color: '#fff',
                stroke: '#aeaeae'
        };
        OrgChart.SEARCH_PLACEHOLDER = "Nhập thông tin tìm kiếm"; // the default value is "Search"
        var chart = new OrgChart(document.getElementById("tree"), {
            //mode: 'dark',
            template: "ula",
            enableSearch: true,
            searchFields: ["name", "title", "phone"],
            searchDisplayField: "name",
            // nodeMouseClick: OrgChart.action.none,
            // mouseScrool: OrgChart.action.none,
            // enableKeyNavigation: true,
            // mouseScrool: OrgChart.action.none,
            //siblingSeparation: 100,
            editForm: {
                generateElementsFromFields: false,
                elements: [
                    { type: 'textbox', label: 'Họ và tên', binding: 'name'},
                    { type: 'textbox', label: 'Mô tả ngắn', binding: 'title'},
                    { type: 'textbox', label: 'Địa chỉ', binding: 'address'},
                    { type: 'date', label: 'Ngày sinh', binding: 'birthdate' },
                    { type: 'date', label: 'Ngày mất', binding: 'deathdate' },
                    { type: 'select', options: [
                        {value: 'male', text: 'Nam'},
                        {value: 'female', text: 'Nữ'}, 
                        {value: 'other', text: 'Khác'}], 
                        label: 'Giới tính', binding: 'sex' },
                    { type: 'textbox', label: 'Điện thoại', binding: 'phone'},
                    { type: 'textbox', label: 'Hình ảnh:', binding: 'img', btn: 'Upload'},  
                    ]
            },
            nodeCircleMenu: {
            showId: {
                icon: OrgChart.icon.info(24, 24, '#aeaeae'),
                text: "Hiển thị ID",
                color: "white"
            },
            addNode: {
                icon: OrgChart.icon.add(24, 24, '#aeaeae'),
                text: "Add node",
                color: "white"
            },
            editNode: {
                icon: OrgChart.icon.edit(24, 24, '#aeaeae'),
                text: "Edit node",
                color: "white"
            },
            addClink: {
                icon: OrgChart.icon.link(24, 24, '#aeaeae'), 
                text: "Add C link",
                color: '#fff',
                draggable: true
            }
            
            },
            nodeBinding: {
                field_0: "name",
                field_1: "title",
                img_0: "img"
                },
            menu: {
                pdf: { text: "Export PDF" },
                png: { text: "Export PNG" },
                svg: { text: "Export SVG" },
                csv: { text: "Export CSV" },
                importCSV: { 
                  text: "Import CSV",
                  icon: OrgChart.icon.csv(24,24, '#7A7A7A'),
                  onClick: function(){ chart.importCSV(); }
                },
            },
            // nodeMenu: {
            //     pdf: { text: "Export PDF" },
            //     png: { text: "Export PNG" },
            //     svg: { text: "Export SVG" }
            // },


            });
                // nodes: [
                //     { id: 1, tags: ["blue"], name: "King George VI", img: "https://cdn.balkan.app/shared/f1.png",phone: "(03) 9252 4642"},
                //     { id: 2, pid: 1, tags: ["partner"], name: "Queen Elizabeth", title: "The Queen Mother", img: "https://cdn.balkan.app/shared/f2.png" },
                // ]
            chart.nodeCircleMenuUI.on('show', function (sender, args){
            var node = chart.getNode(args.nodeId);
                if (args.menu.delete)   
                    delete args.menu.delete;
            if (node.parent && !args.menu.delete){
                args.menu.delete = {
                    icon: OrgChart.icon.remove(24, 24, '#aeaeae'),
                    text: "Remove node",
                    color: "white"
                    };
                }       
            });

            chart.nodeCircleMenuUI.on('click', function (sender, args) {
                switch (args.menuItem.text) {
                    case "Hiển thị ID": alert(args.nodeId);
                    break;
                    case "Add node": {
                        var id = chart.generateId();
                        chart.addNode({ id: id, pid: args.nodeId});
                    }
                    break;
                    case "Edit node": chart.editUI.show(args.nodeId);
                    break;
                    case "Remove node": chart.removeNode(args.nodeId);
                    break;
                    default:
                };
            });

            chart.nodeCircleMenuUI.on('drop', function (sender, args) {
                    chart.addClink(args.from, args.to).draw(OrgChart.action.update);        
            });

            chart.nodeCircleMenuUI.on('mouseenter', function (sender, args) {
                if (args.menuItem.text == "Remove node") {
                    var node = document.querySelector('[data-n-id="' + args.from + '"]');
                    node.style.opacity = 0.5;
                }
            });

            chart.nodeCircleMenuUI.on('mouseout', function (sender, args) {
                var node = document.querySelector('[data-n-id="' + args.from + '"]');
                node.style.opacity = 1;
            });


            // Action cho field link
            //  chart.on('field', function(sender, args){
            //     var name = args.data["name"];
            //                     var link = args.data["link"];
            //         args.value = '<a target="_blank" href="' + link + '">' + name +  '</a>';
            // });
            fetchJSONFile('https://raw.githubusercontent.com/giangcute91/HOANGFARMILY/main/HOANGdata.json', function(data){
                try{
                    chart.load(data);

                } catch(e){
                    console.log("Co loi xay ra");
                }
                
             });

            // chart.load([          
            //     // { id: 1, pid: 0, ppid: 0, tags: ["blue"], name: "King George VI", title: "Top",address:"Thôn Trung Quán", birthdate:"1991-11-20",deathdate:" ",sex:"male" ,phone: "0387074404",img: "https://cdn.balkan.app/shared/f1.png"},
            //     { id: 1, pid: 0, ppid: 0, tags: "blue", name: "King George VI", title: "Top",address:"Thôn Trung Quán", birthdate:"1991-11-20",deathdate:" ",sex:"male" ,phone: "0387074404",img: "https://raw.githubusercontent.com/giangcute91/giangcute91/master/giang1.jpg"},
            //     { id: 2, pid: 1, tags: ["partner"], name: "Queen Elizabeth", title: "The Queen Mother", img: "https://cdn.balkan.app/shared/f2.png" },
            //     { id: 3, pid: 1, tags: ["blue"],  ppid: 2, name: "Queen Elizabeth II", img: "https://cdn.balkan.app/shared/f5.png"},
            //     { id: 4, pid: 3, tags: ["left-partner"], name: "Prince Philip", title: "Duke of Edinburgh", img: "https://cdn.balkan.app/shared/f3.png"},
            //     { id: 5, pid: 1, ppid: 2, name: "Princess Margaret", img: "https://cdn.balkan.app/shared/f6.png"},
            //     { id: 6, pid: 3,tags: ["blue"], ppid: 4, name: "Charles", title: "Prince of Wales", img: "https://cdn.balkan.app/shared/f8.png"},
            //     { id: 7, pid: 6, tags: ["partner"] , name: "Diana", title: "Princess of Wales", img: "https://cdn.balkan.app/shared/f9.png"},
            //     { id: 8, pid: 6, tags: ["partner"], name: "Camila", title: "Duchess of Cornwall", img: "https://cdn.balkan.app/shared/f7.png" },
            //     { id: 9, pid: 3, ppid: 4 , name: "Anne", title: "Princess Royal", img: "https://cdn.balkan.app/shared/f10.png"},
            //     { id: 10, pid: 3, ppid: 4 , name: "Prince Andrew", title: "Duke of York", img: "https://cdn.balkan.app/shared/f11.png"},
            //     { id: 11, pid: 3, ppid: 4, name: "Prince Edward", title: "Earl of Wessex", img: "https://cdn.balkan.app/shared/f12.png"},
            //     { id: 12, pid: 6, ppid: 7, tags: ["blue"], name: "Prince William", title: "Duch of Cambridge", img: "https://cdn.balkan.app/shared/f14.png"},
            //     { id: 13, pid: 6, ppid: 7, name: "Prince Harry", img: "https://cdn.balkan.app/shared/f15.png"},
            //     { id: 14, pid: 12, tags: ["left-partner"], name: "Catherine", title: "Duchess of Cambridge", img: "https://cdn.balkan.app/shared/f13.png"},
            //     { id: 15, pid: 13, tags: ["right-partner"], name: "Meghan Markle", img: "https://cdn.balkan.app/shared/f16.png"},
            //     { id: 16, pid: 12, ppid: 14, tags: ["blue"], name: "Prince George of Cambridge", img: "https://cdn.balkan.app/shared/f17.png"},
            //     { id: 17, pid: 12, ppid: 14, tags: ["blue"], name: "Prince Charlotte of Cambridge", img: "https://cdn.balkan.app/shared/f18.png"},
            //     { id: 18, pid: 12, ppid: 14, tags: ["blue"], name: "Prince Louis of Cambridge", img: "https://cdn.balkan.app/shared/f19.png"},
            //     { id: 19, pid: 13, ppid: 15, tags: ["blue"], name: "Prince Louis of Cambridge", img: "https://cdn.balkan.app/shared/f19.png"},
            //     { id: 20, pid: 13, ppid: 15, tags: ["blue"], name: "Prince Louis of Cambridge", img: "https://cdn.balkan.app/shared/f19.png"}
            // ]);

    };



    // const rankingsBody = document.querySelector("#rankings");
    // function loadranking(){
    //             const request = new XMLHttpRequest();
    //             request.open("get","https://raw.githubusercontent.com/giangcute91/giangcute91/master/ranking.json");
    //             request.onload = () => {
    //                 try {
    //                     const json = JSON.parse(request.responseText);
    //                     populateRankings(json);
    //                 } catch(e){
    //                     console.warn("Co loi xay ra");
    //                 }
                    
    //             };
    //             request.send();
    //         }
            
    //         function populateRankings(json){
    //             // console.log(json);
    //             while(rankingsBody.firstChild) {
    //                 rankingsBody.removeChild(rankingsBody.firstChild);
    //             }           
    //             json.forEach((row) => {
    //                 const tr = document.createElement("tr");
    //                 row.forEach((cell) => {
    //                     const td = document.createElement("td");
    //                     td.textContent = cell;
    //                     tr.appendChild(td);
    //                 });
    //                 rankingsBody.appendChild(tr);
    //             });
    //         }
    //         document.addEventListener("DOMContentLoaded", () => { loadranking(); });



    </script>    
</body>
</html>
